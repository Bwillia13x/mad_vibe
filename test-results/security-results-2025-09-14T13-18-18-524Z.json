{
  "suiteName": "Security Test Suite",
  "startTime": "2025-09-14T13:18:17.816Z",
  "endTime": "2025-09-14T13:18:18.267Z",
  "duration": 451,
  "totalTests": 22,
  "passed": 19,
  "failed": 3,
  "skipped": 0,
  "authenticationResults": [
    {
      "testName": "Admin Token Validation",
      "status": "pass",
      "duration": 5,
      "details": {
        "validTokenStatus": 200,
        "invalidTokenStatus": 200,
        "noTokenStatus": 200
      }
    },
    {
      "testName": "Smoke Mode Security Behavior",
      "status": "pass",
      "duration": 2,
      "details": {
        "smokeResponseStatus": 200,
        "aiDemoMode": true
      }
    },
    {
      "testName": "Session Security Validation",
      "status": "pass",
      "duration": 27,
      "details": {
        "securityHeaders": {
          "x-content-type-options": "nosniff",
          "x-frame-options": "DENY",
          "x-xss-protection": "1; mode=block",
          "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
          "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; object-src 'none'; media-src 'self'; child-src 'none'; form-action 'self'; base-uri 'self'; upgrade-insecure-requests"
        },
        "corsStatus": 200,
        "corsHeaders": {
          "access-control-allow-origin": null,
          "access-control-allow-methods": null
        },
        "sessionTests": [
          {
            "test": "valid_token_session",
            "status": 200,
            "expected": [200, 400],
            "passed": true
          },
          {
            "test": "token_reuse",
            "status1": 200,
            "status2": 200,
            "passed": true
          },
          {
            "test": "concurrent_sessions",
            "statuses": [200, 200, 200, 200, 200],
            "passed": true
          },
          {
            "test": "session_timeout_simulation",
            "status": 200,
            "passed": true
          }
        ],
        "allSessionTestsPassed": true
      }
    },
    {
      "testName": "Authentication Bypass Prevention",
      "status": "pass",
      "duration": 71,
      "details": {
        "bypassAttempts": [
          {
            "endpoint": "/api/demo/seed",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 200,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 400,
            "shouldBeRejected": false,
            "actuallyRejected": false
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          }
        ],
        "validAuthTests": [
          {
            "endpoint": "/api/demo/seed",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/demo/time",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/demo/reset",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/pos/sales",
            "status": 400,
            "authenticated": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "status": 400,
            "authenticated": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "status": 400,
            "authenticated": true
          }
        ],
        "totalBypassAttempts": 90,
        "rejectedAttempts": 78,
        "serverErrors": 0
      }
    },
    {
      "testName": "Session Hijacking Prevention",
      "status": "pass",
      "duration": 3,
      "details": {
        "sessionId1": null,
        "sessionId2": null,
        "manipulatedResponseStatus": 200,
        "concurrentRequestsSuccessful": true,
        "concurrentStatuses": [200, 200, 200]
      }
    },
    {
      "testName": "Comprehensive Authentication Bypass Tests",
      "status": "fail",
      "duration": 52,
      "error": "Authentication bypass tests failed: Token Format Validation, Rate Limiting Protection, Advanced Bypass Attempts"
    }
  ],
  "inputValidationResults": [
    {
      "testName": "Comprehensive XSS Prevention Testing",
      "status": "fail",
      "duration": 184,
      "error": "XSS prevention failures: Critical XSS vulnerabilities found: 1 critical, 5 high severity; Input sanitization failures: 2 tests failed; Content-Security-Policy header is missing"
    },
    {
      "testName": "Comprehensive Input Validation Testing",
      "status": "pass",
      "duration": 35,
      "details": {
        "validationSuiteResults": [
          {
            "testName": "Endpoint Input Validation Coverage",
            "status": "pass",
            "duration": 6,
            "details": {
              "totalEndpoints": 15,
              "validationGaps": 0,
              "testResults": [
                {
                  "endpoint": "POST /api/chat",
                  "description": "Chat API endpoint",
                  "inputFields": ["messages"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "POST /api/demo/seed",
                  "description": "Demo data seeding",
                  "inputFields": ["scenario", "seed"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "POST /api/demo/time",
                  "description": "Demo time controls",
                  "inputFields": ["date", "clear"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "POST /api/pos/sales",
                  "description": "POS sales creation",
                  "inputFields": ["items", "discountPct", "taxPct"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "POST /api/marketing/campaigns",
                  "description": "Marketing campaign creation",
                  "inputFields": ["name", "description", "channel", "status"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "PATCH /api/marketing/campaigns/test-id",
                  "description": "Marketing campaign update",
                  "inputFields": ["name", "description", "channel", "status"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "POST /api/loyalty/entries",
                  "description": "Loyalty entry creation",
                  "inputFields": ["customerId", "type", "points", "note"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                },
                {
                  "endpoint": "GET /api/appointments",
                  "description": "Appointments with query filters",
                  "inputFields": ["day", "date"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/loyalty/entries",
                  "description": "Loyalty entries with customer filter",
                  "inputFields": ["customerId"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/staff/test-id",
                  "description": "Staff member by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/services/test-id",
                  "description": "Service by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/appointments/test-id",
                  "description": "Appointment by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/inventory/test-id",
                  "description": "Inventory item by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "GET /api/analytics/test-id",
                  "description": "Analytics data by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": false
                },
                {
                  "endpoint": "DELETE /api/pos/sales/test-id",
                  "description": "Delete POS sale by ID",
                  "inputFields": ["id"],
                  "status": 429,
                  "validated": true,
                  "requiresAuth": true
                }
              ]
            }
          },
          {
            "testName": "Malicious Payload Detection",
            "status": "pass",
            "duration": 7,
            "details": {
              "totalPayloads": 17,
              "undetectedPayloads": 0,
              "testResults": [
                {
                  "payload": "Basic XSS script injection",
                  "category": "xss",
                  "expectedBehavior": "sanitize",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "XSS via image onerror",
                  "category": "xss",
                  "expectedBehavior": "sanitize",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "JavaScript URL scheme",
                  "category": "xss",
                  "expectedBehavior": "sanitize",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "SQL injection with table drop",
                  "category": "sql",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "SQL injection boolean bypass",
                  "category": "sql",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "SQL injection union select",
                  "category": "sql",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Command injection file deletion",
                  "category": "command",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Command injection file read",
                  "category": "command",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Command injection command substitution",
                  "category": "command",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Path traversal to system files",
                  "category": "path",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Windows path traversal",
                  "category": "path",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Template injection expression",
                  "category": "template",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Template literal injection",
                  "category": "template",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Null byte injection",
                  "category": "null",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Extremely large payload",
                  "category": "dos",
                  "expectedBehavior": "reject",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "JSON object injection",
                  "category": "json",
                  "expectedBehavior": "sanitize",
                  "status": 429,
                  "detected": true
                },
                {
                  "payload": "Unicode BOM and invalid characters",
                  "category": "unicode",
                  "expectedBehavior": "sanitize",
                  "status": 429,
                  "detected": true
                }
              ],
              "detectionRate": "100.0"
            }
          },
          {
            "testName": "Input Sanitization Effectiveness",
            "status": "pass",
            "duration": 3,
            "details": {
              "testResults": [
                {
                  "input": "Mixed malicious and normal content",
                  "expected": "sanitized",
                  "status": 429,
                  "properlyHandled": true,
                  "responseData": "{\"message\":\"Too many requests\",\"error\":\"RATE_LIMIT_EXCEEDED\",\"retryAfter\":60}"
                },
                {
                  "input": "Whitespace handling",
                  "expected": "trimmed",
                  "status": 429,
                  "properlyHandled": true,
                  "responseData": "{\"message\":\"Too many requests\",\"error\":\"RATE_LIMIT_EXCEEDED\",\"retryAfter\":60}"
                },
                {
                  "input": "Legitimate content preservation",
                  "expected": "preserved",
                  "status": 429,
                  "properlyHandled": false,
                  "responseData": "{\"message\":\"Too many requests\",\"error\":\"RATE_LIMIT_EXCEEDED\",\"retryAfter\":60}"
                },
                {
                  "input": "Empty input handling",
                  "expected": "handled",
                  "status": 429,
                  "properlyHandled": true,
                  "responseData": "{\"message\":\"Too many requests\",\"error\":\"RATE_LIMIT_EXCEEDED\",\"retryAfter\":60}"
                }
              ],
              "totalTests": 4,
              "properlyHandled": 3,
              "improperlyHandled": 1
            }
          },
          {
            "testName": "Parameter Validation",
            "status": "pass",
            "duration": 2,
            "details": {
              "testResults": [
                {
                  "description": "Negative quantity validation",
                  "endpoint": "POST /api/pos/sales",
                  "status": 429,
                  "validated": false
                },
                {
                  "description": "Negative price validation",
                  "endpoint": "POST /api/pos/sales",
                  "status": 429,
                  "validated": false
                },
                {
                  "description": "Empty required field validation",
                  "endpoint": "POST /api/loyalty/entries",
                  "status": 429,
                  "validated": false
                },
                {
                  "description": "Invalid enum value validation",
                  "endpoint": "POST /api/loyalty/entries",
                  "status": 429,
                  "validated": false
                }
              ],
              "totalTests": 4,
              "validated": 0,
              "unvalidated": 4
            }
          },
          {
            "testName": "Content-Type Validation",
            "status": "pass",
            "duration": 2,
            "details": {
              "testResults": [
                {
                  "description": "XML content type rejection",
                  "contentType": "application/xml",
                  "status": 429,
                  "rejected": false
                },
                {
                  "description": "HTML content type rejection",
                  "contentType": "text/html",
                  "status": 429,
                  "rejected": false
                },
                {
                  "description": "Form data content type rejection",
                  "contentType": "multipart/form-data",
                  "status": 429,
                  "rejected": false
                },
                {
                  "description": "Missing content type rejection",
                  "contentType": "missing",
                  "status": 429,
                  "rejected": false
                }
              ],
              "totalTests": 4,
              "rejected": 0
            }
          },
          {
            "testName": "Request Size Validation",
            "status": "pass",
            "duration": 15,
            "details": {
              "payloadSize": 5242880,
              "status": 429,
              "rejected": false,
              "description": "Large payload rejection test"
            }
          }
        ],
        "totalValidationTests": 6,
        "passedValidationTests": 6,
        "comprehensiveValidationEnabled": true
      }
    },
    {
      "testName": "SQL Injection Prevention Testing",
      "status": "fail",
      "duration": 7,
      "error": "SQL injection payloads caused unsafe responses: 23 failures"
    },
    {
      "testName": "Malicious Payload Handling",
      "status": "pass",
      "duration": 18,
      "details": {
        "totalPayloads": 12,
        "testResults": [
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 431,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "GET /api/health",
            "status": 429,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 429,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/pos/sales",
            "status": 429,
            "safe": true
          }
        ],
        "serverErrors": 0,
        "errorDetails": []
      }
    },
    {
      "testName": "Input Sanitization Validation",
      "status": "pass",
      "duration": 4,
      "details": {
        "testResults": [
          {
            "input": "<script>alert(\"test\")</script>",
            "expected": "sanitized",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "input": "normal text",
            "expected": "preserved",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "input": "   whitespace   ",
            "expected": "trimmed",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "input": "",
            "expected": "empty_handled",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "input": null,
            "expected": "null_handled",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "expected": "undefined_handled",
            "status": 429,
            "responseData": {
              "message": "Too many requests",
              "error": "RATE_LIMIT_EXCEEDED",
              "retryAfter": 60
            },
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"<script>alert(\\\"xss\\\")</script>\",\"quantity\":1,\"unitPrice\":10}",
            "status": 429,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":-1,\"unitPrice\":10}",
            "status": 429,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":1,\"unitPrice\":-5}",
            "status": 429,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"\",\"quantity\":1,\"unitPrice\":10}",
            "status": 429,
            "handled": false
          }
        ],
        "unhandledInputs": 4,
        "totalTests": 10
      }
    },
    {
      "testName": "File Upload Security Testing",
      "status": "pass",
      "duration": 1,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/upload",
            "status": 429,
            "exists": true
          },
          {
            "endpoint": "/api/files",
            "status": 429,
            "exists": true
          },
          {
            "endpoint": "/api/import",
            "status": 429,
            "exists": true
          },
          {
            "endpoint": "/api/avatar",
            "status": 429,
            "exists": true
          }
        ],
        "existingEndpoints": 4,
        "note": "No file upload endpoints currently implemented"
      }
    }
  ],
  "apiSecurityResults": [
    {
      "testName": "Rate Limiting Validation",
      "status": "pass",
      "duration": 21,
      "details": {
        "rapidRequests": 50,
        "statusCounts": {
          "429": 50
        },
        "rateLimitedRequests": 50,
        "successfulRequests": 0,
        "endpointResults": [
          {
            "endpoint": "/api/health",
            "responses": [
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": true
          },
          {
            "endpoint": "/api/profile",
            "responses": [
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": true
          },
          {
            "endpoint": "/api/services",
            "responses": [
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": true
          },
          {
            "endpoint": "/api/staff",
            "responses": [
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": true
          },
          {
            "endpoint": "/api/analytics",
            "responses": [
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 429,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": true
          }
        ],
        "note": "Rate limiting not currently implemented - this is expected behavior"
      }
    },
    {
      "testName": "Authentication Bypass Testing",
      "status": "pass",
      "duration": 5,
      "details": {
        "totalAttempts": 16,
        "testResults": [
          {
            "description": "IP spoofing",
            "headers": {
              "X-Forwarded-For": "127.0.0.1"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Real IP header",
            "headers": {
              "X-Real-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Originating IP header",
            "headers": {
              "X-Originating-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Curl user agent",
            "headers": {
              "User-Agent": "curl/7.68.0"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Googlebot user agent",
            "headers": {
              "User-Agent": "Mozilla/5.0 (compatible; Googlebot/2.1)"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Localhost referer",
            "headers": {
              "Referer": "https://localhost"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Admin referer",
            "headers": {
              "Referer": "https://admin.localhost"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header injection",
            "headers": {
              "Host": "admin.example.com"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header CRLF injection",
            "headers": {
              "Host": "localhost:80\r\nX-Admin: true"
            },
            "method": "GET",
            "status": 0,
            "safe": false,
            "error": "Headers.append: \"localhost:80\r\nX-Admin: true\" is an invalid header value."
          },
          {
            "description": "Method override",
            "headers": {
              "X-HTTP-Method-Override": "GET"
            },
            "method": "POST",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "HTTP method header",
            "headers": {
              "X-HTTP-Method": "GET"
            },
            "method": "POST",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "UTF-7 charset",
            "headers": {
              "Content-Type": "application/json; charset=utf-7"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Plain text content type",
            "headers": {
              "Content-Type": "text/plain"
            },
            "method": "GET",
            "status": 429,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Parameter pollution",
            "url": "/api/health?test=1&test=2",
            "status": 429,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/appointments?date=2024-01-01&date=2024-12-31",
            "status": 429,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/loyalty/entries?customerId=1&customerId=2",
            "status": 429,
            "safe": true
          }
        ],
        "unsafeResponses": 1
      }
    },
    {
      "testName": "Environment Variable Security",
      "status": "pass",
      "duration": 4,
      "details": {
        "testResults": [
          {
            "url": "/api/health?env=OPENAI_API_KEY",
            "status": 429,
            "containsSensitiveInfo": false,
            "responseLength": 77,
            "safe": true
          },
          {
            "url": "/api/health?debug=true",
            "status": 429,
            "containsSensitiveInfo": false,
            "responseLength": 77,
            "safe": true
          },
          {
            "url": "/api/health?config=true",
            "status": 429,
            "containsSensitiveInfo": false,
            "responseLength": 77,
            "safe": true
          },
          {
            "url": "/api/profile?admin=true",
            "status": 429,
            "containsSensitiveInfo": false,
            "responseLength": 77,
            "safe": true
          },
          {
            "url": "/api/demo/seed?env=production",
            "status": 429,
            "containsSensitiveInfo": false,
            "responseLength": 77,
            "safe": true
          },
          {
            "injection": "${OPENAI_API_KEY}",
            "status": 429,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "#{ENV['ADMIN_TOKEN']}",
            "status": 429,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "%OPENAI_API_KEY%",
            "status": 429,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "$OPENAI_API_KEY",
            "status": 429,
            "containsSensitiveInfo": false,
            "safe": true
          }
        ],
        "exposedInfo": {
          "timestamp": false
        },
        "unsafeTests": 0,
        "note": "Health endpoint appropriately exposes minimal operational information"
      }
    },
    {
      "testName": "API Endpoint Security Validation",
      "status": "pass",
      "duration": 5,
      "details": {
        "testResults": [
          {
            "endpoint": "GET /api/health",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/profile",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/services",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/staff",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/customers",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/appointments",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/inventory",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/analytics",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/pos/sales",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/marketing/campaigns",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/loyalty/entries",
            "status": 429,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/nonexistent",
            "status": 429,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/staff/invalid-id",
            "status": 429,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/services/999999",
            "status": 429,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/appointments/invalid",
            "status": 429,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          }
        ],
        "securityIssues": 0,
        "totalEndpoints": 11,
        "note": "Most endpoints lack security headers - consider adding security middleware"
      }
    },
    {
      "testName": "HTTP Method Security Testing",
      "status": "pass",
      "duration": 6,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/health",
            "method": "GET",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "POST",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PUT",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "DELETE",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PATCH",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "HEAD",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/health",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "GET",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "POST",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PUT",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "DELETE",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PATCH",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "HEAD",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "GET",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "POST",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PUT",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "DELETE",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PATCH",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "HEAD",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          }
        ],
        "dangerousMethodsAllowed": 0,
        "optionsResults": [
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 429,
            "allowed": true,
            "safe": true
          }
        ],
        "totalTests": 27,
        "note": "HTTP method restrictions should be implemented for production"
      }
    }
  ],
  "environmentSecurityResults": [
    {
      "testName": "Environment Variable Validation",
      "status": "pass",
      "duration": 0,
      "details": {
        "configurationValid": true,
        "configurationErrors": [],
        "validationResults": [
          {
            "key": "NODE_ENV",
            "hasValue": true,
            "typeMatch": true,
            "optional": false,
            "valid": true
          },
          {
            "key": "PORT",
            "hasValue": true,
            "typeMatch": true,
            "optional": false,
            "valid": true
          },
          {
            "key": "DATABASE_URL",
            "hasValue": false,
            "typeMatch": true,
            "optional": true,
            "valid": true
          },
          {
            "key": "OPENAI_API_KEY",
            "hasValue": false,
            "typeMatch": true,
            "optional": true,
            "valid": true
          },
          {
            "key": "ADMIN_TOKEN",
            "hasValue": false,
            "typeMatch": true,
            "optional": true,
            "valid": true
          }
        ],
        "invalidConfigs": 0
      }
    },
    {
      "testName": "Sensitive Data Protection",
      "status": "pass",
      "duration": 0,
      "details": {
        "safeConfigKeys": ["PORT", "NODE_ENV", "SMOKE_MODE", "OPERATIONS_WS_PORT"],
        "exposedSensitiveKeys": [],
        "maskingResults": [
          {
            "key": "OPENAI_API_KEY",
            "original": "sk-1234567890abcdef1234567890abcdef12345678",
            "masked": "sk-1***********************************5678",
            "correctlyMasked": true
          },
          {
            "key": "ADMIN_TOKEN",
            "original": "admin123456789012345678901234567890",
            "masked": "admi***************************7890",
            "correctlyMasked": true
          },
          {
            "key": "DATABASE_URL",
            "original": "postgres://user:pass@host:5432/db",
            "masked": "post*************************2/db",
            "correctlyMasked": true
          },
          {
            "key": "PORT",
            "original": "5000",
            "masked": "5000",
            "correctlyMasked": true
          }
        ],
        "incorrectMasking": 0
      }
    },
    {
      "testName": "Configuration Security Audit",
      "status": "pass",
      "duration": 0,
      "details": {
        "audit": {
          "configuredKeys": ["PORT", "NODE_ENV", "SMOKE_MODE", "OPERATIONS_WS_PORT"],
          "sensitiveKeys": [],
          "missingRecommended": [],
          "weakConfigurations": []
        },
        "securityIssues": [],
        "formatTests": [],
        "formatIssues": 0,
        "totalConfiguredKeys": 4,
        "sensitiveKeysCount": 0
      }
    },
    {
      "testName": "Environment Variable Injection Prevention",
      "status": "pass",
      "duration": 0,
      "details": {
        "sanitizationResults": [
          {
            "input": "normal_value",
            "expected": "normal_value",
            "sanitized": "normal_value",
            "correct": true,
            "safe": true
          },
          {
            "input": "value\u0000with\u0001control",
            "expected": "valuewithcontrol",
            "sanitized": "valuewithcontrol",
            "correct": true,
            "safe": true
          },
          {
            "input": "value\r\nwith\r\nnewlines",
            "expected": "valuewithnewlines",
            "sanitized": "valuewithnewlines",
            "correct": true,
            "safe": true
          },
          {
            "input": "  spaced_value  ",
            "expected": "spaced_value",
            "sanitized": "spaced_value",
            "correct": true,
            "safe": true
          },
          {
            "input": "",
            "correct": true,
            "safe": true
          },
          {
            "input": "\u0000\u0001\u0002",
            "correct": true,
            "safe": true
          }
        ],
        "failedSanitization": 0,
        "injectionResults": [
          {
            "pattern": "${ADMIN_TOKEN}",
            "sanitized": "${ADMIN_TOKEN}",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "#{ENV['OPENAI_API_KEY']}",
            "sanitized": "#{ENV['OPENAI_API_KEY']}",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "%OPENAI_API_KEY%",
            "sanitized": "%OPENAI_API_KEY%",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "$OPENAI_API_KEY",
            "sanitized": "$OPENAI_API_KEY",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "`env`",
            "sanitized": "`env`",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "$(env)",
            "sanitized": "$(env)",
            "blocked": true,
            "safe": true
          },
          {
            "pattern": "../../../etc/passwd",
            "sanitized": "../../../etc/passwd",
            "blocked": true,
            "safe": true
          }
        ],
        "note": "Environment variable injection prevention relies on proper input sanitization"
      }
    },
    {
      "testName": "Secrets Management Security",
      "status": "pass",
      "duration": 0,
      "details": {
        "secretsTests": [
          {
            "key": "OPENAI_API_KEY",
            "configured": false,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "ADMIN_TOKEN",
            "configured": false,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "DATABASE_URL",
            "configured": false,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "POSTGRES_URL",
            "configured": false,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "NODE_ENV",
            "configured": true,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "PORT",
            "configured": true,
            "markedSensitive": false,
            "correct": true
          },
          {
            "key": "DEMO_SCENARIO",
            "configured": false,
            "markedSensitive": false,
            "correct": true
          }
        ],
        "incorrectClassification": 0,
        "rotationReadiness": {
          "hasConfigValidation": true,
          "hasSecureDefaults": true,
          "hasMasking": true,
          "hasAuditCapability": true
        },
        "rotationScore": 4,
        "totalSensitiveKeys": 0,
        "note": "Secrets management includes classification, masking, and audit capabilities"
      }
    }
  ],
  "summary": {
    "criticalIssues": 3,
    "warnings": 1,
    "recommendations": [
      "Fix authentication security failures before production deployment",
      "Address input validation failures to prevent injection attacks",
      "Add security headers to all API endpoints",
      "Consider implementing Content Security Policy (CSP) headers",
      "Add request logging and monitoring for security events",
      "Implement proper error handling to prevent information disclosure",
      "Consider adding API authentication for sensitive endpoints",
      "Implement CORS policy appropriate for production environment"
    ]
  }
}
