{
  "suiteName": "Security Test Suite",
  "startTime": "2025-09-14T01:07:59.445Z",
  "endTime": "2025-09-14T01:07:59.709Z",
  "duration": 264,
  "totalTests": 16,
  "passed": 16,
  "failed": 0,
  "skipped": 0,
  "authenticationResults": [
    {
      "testName": "Admin Token Validation",
      "status": "pass",
      "duration": 3,
      "details": {
        "validTokenStatus": 200,
        "invalidTokenStatus": 200,
        "noTokenStatus": 200
      }
    },
    {
      "testName": "Smoke Mode Security Behavior",
      "status": "pass",
      "duration": 2,
      "details": {
        "smokeResponseStatus": 200,
        "aiDemoMode": false
      }
    },
    {
      "testName": "Session Security Validation",
      "status": "pass",
      "duration": 27,
      "details": {
        "securityHeaders": {
          "x-content-type-options": "nosniff",
          "x-frame-options": "DENY",
          "x-xss-protection": "1; mode=block",
          "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
          "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';"
        },
        "corsStatus": 200,
        "corsHeaders": {
          "access-control-allow-origin": null,
          "access-control-allow-methods": null
        },
        "sessionTests": [
          {
            "test": "valid_token_session",
            "status": 200,
            "expected": [200, 400],
            "passed": true
          },
          {
            "test": "token_reuse",
            "status1": 200,
            "status2": 200,
            "passed": true
          },
          {
            "test": "concurrent_sessions",
            "statuses": [200, 200, 200, 200, 200],
            "passed": true
          },
          {
            "test": "session_timeout_simulation",
            "status": 200,
            "passed": true
          }
        ],
        "allSessionTestsPassed": true
      }
    },
    {
      "testName": "Authentication Bypass Prevention",
      "status": "pass",
      "duration": 52,
      "details": {
        "bypassAttempts": [
          {
            "endpoint": "/api/demo/seed",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/seed",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/time",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/demo/reset",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/pos/sales",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {},
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": ""
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Basic admin-token"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer ' OR '1'='1"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer test\r\nX-Admin: true"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer \u0000admin"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer \u0000admin\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer admin\u0000"
            },
            "status": "error",
            "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value.",
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "authorization": "Bearer admin"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": ["Bearer fake", "Bearer admin"]
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer <script>alert(1)</script>"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer admin; rm -rf /"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer ../../../etc/passwd"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer {\"admin\": true}"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "headers": {
              "Authorization": "Bearer aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
            },
            "status": 401,
            "shouldBeRejected": true,
            "actuallyRejected": true
          }
        ],
        "validAuthTests": [
          {
            "endpoint": "/api/demo/seed",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/demo/time",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/demo/reset",
            "status": 200,
            "authenticated": true
          },
          {
            "endpoint": "/api/pos/sales",
            "status": 400,
            "authenticated": true
          },
          {
            "endpoint": "/api/marketing/campaigns",
            "status": 400,
            "authenticated": true
          },
          {
            "endpoint": "/api/loyalty/entries",
            "status": 400,
            "authenticated": true
          }
        ],
        "totalBypassAttempts": 90,
        "rejectedAttempts": 90,
        "serverErrors": 0
      }
    },
    {
      "testName": "Session Hijacking Prevention",
      "status": "pass",
      "duration": 2,
      "details": {
        "sessionId1": null,
        "sessionId2": null,
        "manipulatedResponseStatus": 200,
        "concurrentRequestsSuccessful": true,
        "concurrentStatuses": [200, 200, 200]
      }
    },
    {
      "testName": "Comprehensive Authentication Bypass Tests",
      "status": "pass",
      "duration": 38,
      "details": {
        "bypassTestResults": [
          {
            "testName": "Header Injection Prevention",
            "status": "pass",
            "duration": 0,
            "details": {
              "injectionAttempts": [
                {
                  "header": "Bearer token\r\nX-Admin: true...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\r\nX-Admin: true\" is an invalid header value."
                },
                {
                  "header": "Bearer token\nX-Admin: true...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\nX-Admin: true\" is an invalid header value."
                },
                {
                  "header": "Bearer token\u0000admin...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\u0000admin\" is an invalid header value."
                },
                {
                  "header": "Bearer token\u0000admin...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\u0000admin\" is an invalid header value."
                },
                {
                  "header": "Bearer token\r\nContent-Length: ...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\r\nContent-Length: 0\r\n\r\nGET /admin\" is an invalid header value."
                },
                {
                  "header": "Bearer token\nSet-Cookie: admin...",
                  "status": "blocked",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer token\nSet-Cookie: admin=true\" is an invalid header value."
                }
              ],
              "totalAttempts": 6,
              "blockedAttempts": 6
            }
          },
          {
            "testName": "Token Format Validation",
            "status": "pass",
            "duration": 16,
            "details": {
              "tokenTests": [
                {
                  "token": "' OR '1'='1",
                  "tokenLength": 11,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "<script>alert(1)</script>",
                  "tokenLength": 25,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin; rm -rf /",
                  "tokenLength": 15,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "../../../etc/passwd",
                  "tokenLength": 19,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "{\"admin\": true}",
                  "tokenLength": 15,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin\u0000",
                  "tokenLength": 6,
                  "status": "error",
                  "blocked": true,
                  "error": "Headers.append: \"Bearer admin\u0000\" is an invalid header value."
                },
                {
                  "token": "admin\r\n",
                  "tokenLength": 7,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin\n",
                  "tokenLength": 6,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin\\x27",
                  "tokenLength": 9,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin%27",
                  "tokenLength": 8,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin/*comment*/",
                  "tokenLength": 16,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin--comment",
                  "tokenLength": 14,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin#comment",
                  "tokenLength": 13,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin?param=value",
                  "tokenLength": 17,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin:password",
                  "tokenLength": 14,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin@@version",
                  "tokenLength": 14,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin UNION SELECT 1",
                  "tokenLength": 20,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "javascript:alert(1)",
                  "tokenLength": 19,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "vbscript:msgbox(1)",
                  "tokenLength": 18,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "onload=alert(1)",
                  "tokenLength": 15,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "onerror=alert(1)",
                  "tokenLength": 16,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "eval(alert(1))",
                  "tokenLength": 14,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "exec('rm -rf /')",
                  "tokenLength": 16,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa...",
                  "tokenLength": 1000,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "",
                  "tokenLength": 0,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": " ",
                  "tokenLength": 1,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin ",
                  "tokenLength": 6,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": " admin",
                  "tokenLength": 6,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "ad min",
                  "tokenLength": 6,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin\t",
                  "tokenLength": 6,
                  "status": 401,
                  "blocked": true
                },
                {
                  "token": "admin\u000b",
                  "tokenLength": 6,
                  "status": "error",
                  "blocked": true,
                  "error": "fetch failed"
                },
                {
                  "token": "admin\f",
                  "tokenLength": 6,
                  "status": "error",
                  "blocked": true,
                  "error": "fetch failed"
                },
                {
                  "token": "admin\b",
                  "tokenLength": 6,
                  "status": "error",
                  "blocked": true,
                  "error": "fetch failed"
                }
              ],
              "totalTokens": 33,
              "blockedTokens": 33
            }
          },
          {
            "testName": "Rate Limiting Protection",
            "status": "pass",
            "duration": 11,
            "details": {
              "attempts": [
                {
                  "attempt": 1,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 2,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 3,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 4,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 5,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 6,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 7,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 8,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 9,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 10,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 11,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 12,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 13,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 14,
                  "status": 401,
                  "rateLimited": false
                },
                {
                  "attempt": 15,
                  "status": 401,
                  "rateLimited": false
                }
              ],
              "totalAttempts": 15,
              "rateLimitedAttempts": 0,
              "firstRateLimitAt": "none",
              "rateLimitingDisabled": true,
              "testMode": "authentication_validation"
            }
          },
          {
            "testName": "Security Headers Presence",
            "status": "pass",
            "duration": 1,
            "details": {
              "headers": {
                "x-content-type-options": "nosniff",
                "x-frame-options": "DENY",
                "x-xss-protection": "1; mode=block",
                "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';"
              },
              "poweredByRemoved": true,
              "allHeadersPresent": true
            }
          },
          {
            "testName": "Session Security Validation",
            "status": "pass",
            "duration": 2,
            "details": {
              "sessionTests": [
                {
                  "test": "valid_authentication",
                  "passed": true,
                  "status": 200
                },
                {
                  "test": "session_id_present",
                  "passed": true,
                  "sessionId": "sess_mfizxd54_trztmxwuzi"
                },
                {
                  "test": "auth_time_present",
                  "passed": true,
                  "authTime": "2025-09-14T01:07:59.560Z"
                },
                {
                  "test": "session_id_changes",
                  "passed": true,
                  "firstSessionId": "sess_mfizxd54_trztmxwuzi",
                  "secondSessionId": "sess_mfizxd55_6omhcow5mte"
                }
              ],
              "allTestsPassed": true
            }
          },
          {
            "testName": "Advanced Bypass Attempts",
            "status": "pass",
            "duration": 8,
            "details": {
              "bypassAttempts": [
                {
                  "description": "lowercase header",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "uppercase header",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "multiple auth headers",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "zero-width space",
                  "status": "blocked",
                  "blocked": true,
                  "success": false,
                  "error": "Cannot convert argument to a ByteString because the character at index 12 has a value of 8203 which is greater than 255."
                },
                {
                  "description": "BOM character",
                  "status": "blocked",
                  "blocked": true,
                  "success": false,
                  "error": "Cannot convert argument to a ByteString because the character at index 7 has a value of 65279 which is greater than 255."
                },
                {
                  "description": "URL encoded",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "hex encoded",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "basic auth",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "digest auth",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "very long token",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "null byte injection",
                  "status": "blocked",
                  "blocked": true,
                  "success": false,
                  "error": "Headers.append: \"Bearer admin\u0000bypass\" is an invalid header value."
                },
                {
                  "description": "template injection",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "ruby template injection",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "path traversal",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "command injection backticks",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "command injection dollar",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "LDAP injection",
                  "status": 401,
                  "blocked": true,
                  "success": false
                },
                {
                  "description": "NoSQL injection",
                  "status": 401,
                  "blocked": true,
                  "success": false
                }
              ],
              "totalAttempts": 18,
              "blockedAttempts": 18,
              "unblockedAttempts": 0
            }
          }
        ],
        "totalBypassTests": 6,
        "passedBypassTests": 6,
        "failedBypassTests": 0
      }
    }
  ],
  "inputValidationResults": [
    {
      "testName": "XSS Prevention Testing",
      "status": "pass",
      "duration": 8,
      "details": {
        "totalPayloads": 10,
        "testResults": [
          {
            "payload": "<script>alert(\"XSS\")</script>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\"><script>alert(\"XSS\")</script>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "';alert('XSS');//",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "<img src=x onerror=alert(\"XSS\")>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "javascript:alert(\"XSS\")",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "<svg onload=alert(\"XSS\")>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "&lt;script&gt;alert(\"XSS\")&lt;/script&gt;",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "%3Cscript%3Ealert(\"XSS\")%3C/script%3E",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "<iframe src=\"javascript:alert('XSS')\"></iframe>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "<body onload=alert(\"XSS\")>",
            "location": "query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "<script>alert(\"XSS\")</script>",
            "location": "campaign_name",
            "status": 401,
            "safe": true
          },
          {
            "payload": "<script>alert(\"XSS\")</script>",
            "location": "demo_scenario",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\"><script>alert(\"XSS\")</script>",
            "location": "campaign_name",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\"><script>alert(\"XSS\")</script>",
            "location": "demo_scenario",
            "status": 401,
            "safe": true
          },
          {
            "payload": "';alert('XSS');//",
            "location": "campaign_name",
            "status": 401,
            "safe": true
          },
          {
            "payload": "';alert('XSS');//",
            "location": "demo_scenario",
            "status": 401,
            "safe": true
          }
        ],
        "serverErrors": 0
      }
    },
    {
      "testName": "SQL Injection Prevention Testing",
      "status": "pass",
      "duration": 10,
      "details": {
        "totalPayloads": 10,
        "testResults": [
          {
            "payload": "' OR '1'='1",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR '1'='1",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'--",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'--",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'/*",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'/*",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 1=1#",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 1=1#",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 'a'='a",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 'a'='a",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "') OR ('1'='1",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "') OR ('1'='1",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; EXEC xp_cmdshell('dir'); --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; EXEC xp_cmdshell('dir'); --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR '1'='1",
            "location": "date_query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "date_query",
            "status": 400,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "date_query",
            "status": 400,
            "safe": true
          }
        ],
        "unsafeResponses": 0
      }
    },
    {
      "testName": "Malicious Payload Handling",
      "status": "pass",
      "duration": 25,
      "details": {
        "totalPayloads": 12,
        "testResults": [
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 431,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 401,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/pos/sales",
            "status": 401,
            "safe": true
          }
        ],
        "serverErrors": 0,
        "errorDetails": []
      }
    },
    {
      "testName": "Input Sanitization Validation",
      "status": "pass",
      "duration": 6,
      "details": {
        "testResults": [
          {
            "input": "<script>alert(\"test\")</script>",
            "expected": "sanitized",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "input": "normal text",
            "expected": "preserved",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "input": "   whitespace   ",
            "expected": "trimmed",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "input": "",
            "expected": "empty_handled",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "input": null,
            "expected": "null_handled",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "expected": "undefined_handled",
            "status": 401,
            "responseData": {
              "message": "Authentication required",
              "error": "MISSING_AUTH_HEADER"
            },
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"<script>alert(\\\"xss\\\")</script>\",\"quantity\":1,\"unitPrice\":10}",
            "status": 401,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":-1,\"unitPrice\":10}",
            "status": 401,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":1,\"unitPrice\":-5}",
            "status": 401,
            "handled": false
          },
          {
            "input": "POS item: {\"name\":\"\",\"quantity\":1,\"unitPrice\":10}",
            "status": 401,
            "handled": false
          }
        ],
        "unhandledInputs": 4,
        "totalTests": 10
      }
    },
    {
      "testName": "File Upload Security Testing",
      "status": "pass",
      "duration": 4,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/upload",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/files",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/import",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/avatar",
            "status": 200,
            "exists": true
          }
        ],
        "existingEndpoints": 4,
        "note": "No file upload endpoints currently implemented"
      }
    }
  ],
  "apiSecurityResults": [
    {
      "testName": "Rate Limiting Validation",
      "status": "pass",
      "duration": 41,
      "details": {
        "rapidRequests": 50,
        "statusCounts": {
          "200": 50
        },
        "rateLimitedRequests": 0,
        "successfulRequests": 50,
        "endpointResults": [
          {
            "endpoint": "/api/health",
            "responses": [
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/profile",
            "responses": [
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/services",
            "responses": [
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/staff",
            "responses": [
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/analytics",
            "responses": [
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          }
        ],
        "note": "Rate limiting not currently implemented - this is expected behavior"
      }
    },
    {
      "testName": "Authentication Bypass Testing",
      "status": "pass",
      "duration": 8,
      "details": {
        "totalAttempts": 16,
        "testResults": [
          {
            "description": "IP spoofing",
            "headers": {
              "X-Forwarded-For": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Real IP header",
            "headers": {
              "X-Real-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Originating IP header",
            "headers": {
              "X-Originating-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Curl user agent",
            "headers": {
              "User-Agent": "curl/7.68.0"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Googlebot user agent",
            "headers": {
              "User-Agent": "Mozilla/5.0 (compatible; Googlebot/2.1)"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Localhost referer",
            "headers": {
              "Referer": "https://localhost"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Admin referer",
            "headers": {
              "Referer": "https://admin.localhost"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header injection",
            "headers": {
              "Host": "admin.example.com"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header CRLF injection",
            "headers": {
              "Host": "localhost:80\r\nX-Admin: true"
            },
            "method": "GET",
            "status": 0,
            "safe": false,
            "error": "Headers.append: \"localhost:80\r\nX-Admin: true\" is an invalid header value."
          },
          {
            "description": "Method override",
            "headers": {
              "X-HTTP-Method-Override": "GET"
            },
            "method": "POST",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "text/html; charset=UTF-8",
              "server": null
            }
          },
          {
            "description": "HTTP method header",
            "headers": {
              "X-HTTP-Method": "GET"
            },
            "method": "POST",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "text/html; charset=UTF-8",
              "server": null
            }
          },
          {
            "description": "UTF-7 charset",
            "headers": {
              "Content-Type": "application/json; charset=utf-7"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Plain text content type",
            "headers": {
              "Content-Type": "text/plain"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Parameter pollution",
            "url": "/api/health?test=1&test=2",
            "status": 200,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/appointments?date=2024-01-01&date=2024-12-31",
            "status": 400,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/loyalty/entries?customerId=1&customerId=2",
            "status": 200,
            "safe": true
          }
        ],
        "unsafeResponses": 1
      }
    },
    {
      "testName": "Environment Variable Security",
      "status": "pass",
      "duration": 12,
      "details": {
        "testResults": [
          {
            "url": "/api/health?env=OPENAI_API_KEY",
            "status": 200,
            "containsSensitiveInfo": false,
            "responseLength": 161,
            "safe": true
          },
          {
            "url": "/api/health?debug=true",
            "status": 200,
            "containsSensitiveInfo": false,
            "responseLength": 161,
            "safe": true
          },
          {
            "url": "/api/health?config=true",
            "status": 200,
            "containsSensitiveInfo": false,
            "responseLength": 161,
            "safe": true
          },
          {
            "url": "/api/profile?admin=true",
            "status": 200,
            "containsSensitiveInfo": false,
            "responseLength": 946,
            "safe": true
          },
          {
            "url": "/api/demo/seed?env=production",
            "status": 200,
            "containsSensitiveInfo": false,
            "responseLength": 2424,
            "safe": true
          },
          {
            "injection": "${OPENAI_API_KEY}",
            "status": 401,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "#{ENV['ADMIN_TOKEN']}",
            "status": 401,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "%OPENAI_API_KEY%",
            "status": 401,
            "containsSensitiveInfo": false,
            "safe": true
          },
          {
            "injection": "$OPENAI_API_KEY",
            "status": 401,
            "containsSensitiveInfo": false,
            "safe": true
          }
        ],
        "exposedInfo": {
          "env": "production",
          "aiDemoMode": false,
          "scenario": "test",
          "timestamp": true
        },
        "unsafeTests": 0,
        "note": "Health endpoint appropriately exposes minimal operational information"
      }
    },
    {
      "testName": "API Endpoint Security Validation",
      "status": "pass",
      "duration": 10,
      "details": {
        "testResults": [
          {
            "endpoint": "GET /api/health",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/profile",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/services",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/staff",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/customers",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/appointments",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/inventory",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/analytics",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/pos/sales",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/marketing/campaigns",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/loyalty/entries",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": "nosniff",
              "x-frame-options": "DENY",
              "x-xss-protection": "1; mode=block",
              "strict-transport-security": "max-age=31536000; includeSubDomains; preload",
              "content-security-policy": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none';",
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": true
          },
          {
            "endpoint": "GET /api/nonexistent",
            "status": 200,
            "exposesStackTrace": false,
            "exposesFilePaths": true,
            "safe": false
          },
          {
            "endpoint": "GET /api/staff/invalid-id",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/services/999999",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/appointments/invalid",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          }
        ],
        "securityIssues": 1,
        "totalEndpoints": 11,
        "note": "Most endpoints lack security headers - consider adding security middleware"
      }
    },
    {
      "testName": "HTTP Method Security Testing",
      "status": "pass",
      "duration": 13,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/health",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/health",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          }
        ],
        "dangerousMethodsAllowed": 0,
        "optionsResults": [
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          }
        ],
        "totalTests": 27,
        "note": "HTTP method restrictions should be implemented for production"
      }
    }
  ],
  "summary": {
    "criticalIssues": 0,
    "warnings": 2,
    "recommendations": [
      "Implement rate limiting to prevent abuse",
      "Add security headers to all API endpoints",
      "Consider implementing Content Security Policy (CSP) headers",
      "Add request logging and monitoring for security events",
      "Implement proper error handling to prevent information disclosure",
      "Consider adding API authentication for sensitive endpoints",
      "Implement CORS policy appropriate for production environment"
    ]
  }
}
