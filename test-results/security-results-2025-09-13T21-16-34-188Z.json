{
  "suiteName": "Security Test Suite",
  "startTime": "2025-09-13T21:16:33.909Z",
  "endTime": "2025-09-13T21:16:34.077Z",
  "duration": 168,
  "totalTests": 15,
  "passed": 12,
  "failed": 3,
  "skipped": 0,
  "authenticationResults": [
    {
      "testName": "Admin Token Validation",
      "status": "pass",
      "duration": 4,
      "details": {
        "validTokenStatus": 200,
        "invalidTokenStatus": 200,
        "noTokenStatus": 200
      }
    },
    {
      "testName": "Smoke Mode Security Behavior",
      "status": "pass",
      "duration": 1,
      "details": {
        "smokeResponseStatus": 200,
        "aiDemoMode": false
      }
    },
    {
      "testName": "Session Security Validation",
      "status": "pass",
      "duration": 4,
      "details": {
        "securityHeaders": {
          "x-content-type-options": null,
          "x-frame-options": null,
          "x-xss-protection": null,
          "strict-transport-security": null
        },
        "corsStatus": 200,
        "corsHeaders": {
          "access-control-allow-origin": null,
          "access-control-allow-methods": null
        }
      }
    },
    {
      "testName": "Authentication Bypass Prevention",
      "status": "fail",
      "duration": 1,
      "error": "Headers.append: \"Bearer test\r\nX-Admin: true\" is an invalid header value."
    },
    {
      "testName": "Session Hijacking Prevention",
      "status": "pass",
      "duration": 5,
      "details": {
        "sessionId1": null,
        "sessionId2": null,
        "manipulatedResponseStatus": 200,
        "concurrentRequestsSuccessful": true,
        "concurrentStatuses": [
          200,
          200,
          200
        ]
      }
    }
  ],
  "inputValidationResults": [
    {
      "testName": "XSS Prevention Testing",
      "status": "fail",
      "duration": 7,
      "error": "payload is not defined"
    },
    {
      "testName": "SQL Injection Prevention Testing",
      "status": "pass",
      "duration": 8,
      "details": {
        "totalPayloads": 10,
        "testResults": [
          {
            "payload": "' OR '1'='1",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR '1'='1",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'--",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'--",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'/*",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "admin'/*",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 1=1#",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 1=1#",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 'a'='a",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR 'a'='a",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "') OR ('1'='1",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "') OR ('1'='1",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "1' AND (SELECT COUNT(*) FROM users) > 0 --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; EXEC xp_cmdshell('dir'); --",
            "location": "staff_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "'; EXEC xp_cmdshell('dir'); --",
            "location": "service_id",
            "status": 404,
            "safe": true
          },
          {
            "payload": "' OR '1'='1",
            "location": "date_query",
            "status": 200,
            "safe": true
          },
          {
            "payload": "'; DROP TABLE users; --",
            "location": "date_query",
            "status": 400,
            "safe": true
          },
          {
            "payload": "' UNION SELECT * FROM users --",
            "location": "date_query",
            "status": 400,
            "safe": true
          }
        ],
        "unsafeResponses": 0
      }
    },
    {
      "testName": "Malicious Payload Handling",
      "status": "pass",
      "duration": 34,
      "details": {
        "totalPayloads": 12,
        "testResults": [
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "GET /api/health",
            "status": 431,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA...",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "test\u0000admin",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "﻿￾￿",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "‮‭‬",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\r\n\r\nHTTP/1.1 200 OK\r\n\r\n<script>alert(\"XSS\")</scrip...",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "{\"admin\": true}",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "\"}{\"admin\": true}{\"",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "&lt;&gt;&amp;&quot;&#x27;&#x2F;",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "../../../etc/passwd",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "GET /api/health",
            "status": 200,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/marketing/campaigns",
            "status": 200,
            "safe": true
          },
          {
            "payload": "..\\..\\..\\windows\\system32\\config\\sam",
            "endpoint": "POST /api/pos/sales",
            "status": 400,
            "safe": true
          }
        ],
        "serverErrors": 0,
        "errorDetails": []
      }
    },
    {
      "testName": "Input Sanitization Validation",
      "status": "pass",
      "duration": 6,
      "details": {
        "testResults": [
          {
            "input": "<script>alert(\"test\")</script>",
            "expected": "sanitized",
            "status": 200,
            "responseData": {
              "id": "7e7cd239-249d-4c7a-8f5a-7d7ac0af8854",
              "name": "<script>alert(\"test\")</script>",
              "description": "Test campaign",
              "channel": "email",
              "status": "draft",
              "createdAt": "2025-09-13T21:16:33.974Z"
            },
            "handled": true
          },
          {
            "input": "normal text",
            "expected": "preserved",
            "status": 200,
            "responseData": {
              "id": "5cc4e3ab-9b05-4990-b8d0-f6abaeaca266",
              "name": "normal text",
              "description": "Test campaign",
              "channel": "email",
              "status": "draft",
              "createdAt": "2025-09-13T21:16:33.975Z"
            },
            "handled": true
          },
          {
            "input": "   whitespace   ",
            "expected": "trimmed",
            "status": 200,
            "responseData": {
              "id": "497733fd-4fb3-4ec0-a291-212fbb9a47d0",
              "name": "   whitespace   ",
              "description": "Test campaign",
              "channel": "email",
              "status": "draft",
              "createdAt": "2025-09-13T21:16:33.975Z"
            },
            "handled": true
          },
          {
            "input": "",
            "expected": "empty_handled",
            "status": 400,
            "responseData": {
              "message": "Name is required"
            },
            "handled": true
          },
          {
            "input": null,
            "expected": "null_handled",
            "status": 400,
            "responseData": {
              "message": "Name is required"
            },
            "handled": true
          },
          {
            "expected": "undefined_handled",
            "status": 400,
            "responseData": {
              "message": "Name is required"
            },
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"<script>alert(\\\"xss\\\")</script>\",\"quantity\":1,\"unitPrice\":10}",
            "status": 400,
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":-1,\"unitPrice\":10}",
            "status": 400,
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"Valid Item\",\"quantity\":1,\"unitPrice\":-5}",
            "status": 400,
            "handled": true
          },
          {
            "input": "POS item: {\"name\":\"\",\"quantity\":1,\"unitPrice\":10}",
            "status": 400,
            "handled": true
          }
        ],
        "unhandledInputs": 0,
        "totalTests": 10
      }
    },
    {
      "testName": "File Upload Security Testing",
      "status": "pass",
      "duration": 3,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/upload",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/files",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/import",
            "status": 200,
            "exists": true
          },
          {
            "endpoint": "/api/avatar",
            "status": 200,
            "exists": true
          }
        ],
        "existingEndpoints": 4,
        "note": "No file upload endpoints currently implemented"
      }
    }
  ],
  "apiSecurityResults": [
    {
      "testName": "Rate Limiting Validation",
      "status": "pass",
      "duration": 48,
      "details": {
        "rapidRequests": 50,
        "statusCounts": {
          "200": 50
        },
        "rateLimitedRequests": 0,
        "successfulRequests": 50,
        "endpointResults": [
          {
            "endpoint": "/api/health",
            "responses": [
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/health",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/profile",
            "responses": [
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/profile",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/services",
            "responses": [
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/services",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/staff",
            "responses": [
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/staff",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          },
          {
            "endpoint": "/api/analytics",
            "responses": [
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              },
              {
                "endpoint": "/api/analytics",
                "status": 200,
                "headers": {
                  "x-ratelimit-limit": null,
                  "x-ratelimit-remaining": null,
                  "x-ratelimit-reset": null
                }
              }
            ],
            "rateLimited": false
          }
        ],
        "note": "Rate limiting not currently implemented - this is expected behavior"
      }
    },
    {
      "testName": "Authentication Bypass Testing",
      "status": "pass",
      "duration": 14,
      "details": {
        "totalAttempts": 16,
        "testResults": [
          {
            "description": "IP spoofing",
            "headers": {
              "X-Forwarded-For": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Real IP header",
            "headers": {
              "X-Real-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Originating IP header",
            "headers": {
              "X-Originating-IP": "127.0.0.1"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Curl user agent",
            "headers": {
              "User-Agent": "curl/7.68.0"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Googlebot user agent",
            "headers": {
              "User-Agent": "Mozilla/5.0 (compatible; Googlebot/2.1)"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Localhost referer",
            "headers": {
              "Referer": "https://localhost"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Admin referer",
            "headers": {
              "Referer": "https://admin.localhost"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header injection",
            "headers": {
              "Host": "admin.example.com"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Host header CRLF injection",
            "headers": {
              "Host": "localhost:80\r\nX-Admin: true"
            },
            "method": "GET",
            "status": 0,
            "safe": false,
            "error": "Headers.append: \"localhost:80\r\nX-Admin: true\" is an invalid header value."
          },
          {
            "description": "Method override",
            "headers": {
              "X-HTTP-Method-Override": "GET"
            },
            "method": "POST",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "text/html; charset=UTF-8",
              "server": null
            }
          },
          {
            "description": "HTTP method header",
            "headers": {
              "X-HTTP-Method": "GET"
            },
            "method": "POST",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "text/html; charset=UTF-8",
              "server": null
            }
          },
          {
            "description": "UTF-7 charset",
            "headers": {
              "Content-Type": "application/json; charset=utf-7"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Plain text content type",
            "headers": {
              "Content-Type": "text/plain"
            },
            "method": "GET",
            "status": 200,
            "safe": true,
            "responseHeaders": {
              "content-type": "application/json; charset=utf-8",
              "server": null
            }
          },
          {
            "description": "Parameter pollution",
            "url": "/api/health?test=1&test=2",
            "status": 200,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/appointments?date=2024-01-01&date=2024-12-31",
            "status": 400,
            "safe": true
          },
          {
            "description": "Parameter pollution",
            "url": "/api/loyalty/entries?customerId=1&customerId=2",
            "status": 200,
            "safe": true
          }
        ],
        "unsafeResponses": 1
      }
    },
    {
      "testName": "Environment Variable Security",
      "status": "fail",
      "duration": 8,
      "error": "Environment variable security issues detected: 4 failures"
    },
    {
      "testName": "API Endpoint Security Validation",
      "status": "pass",
      "duration": 12,
      "details": {
        "testResults": [
          {
            "endpoint": "GET /api/health",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/profile",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/services",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/staff",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/customers",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/appointments",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/inventory",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/analytics",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/pos/sales",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/marketing/campaigns",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/loyalty/entries",
            "status": 200,
            "securityHeaders": {
              "x-content-type-options": null,
              "x-frame-options": null,
              "x-xss-protection": null,
              "strict-transport-security": null,
              "content-security-policy": null,
              "referrer-policy": null
            },
            "contentType": "application/json; charset=utf-8",
            "server": null,
            "exposesServer": false,
            "hasSecurityHeaders": false
          },
          {
            "endpoint": "GET /api/nonexistent",
            "status": 200,
            "exposesStackTrace": false,
            "exposesFilePaths": true,
            "safe": false
          },
          {
            "endpoint": "GET /api/staff/invalid-id",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/services/999999",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          },
          {
            "endpoint": "GET /api/appointments/invalid",
            "status": 404,
            "exposesStackTrace": false,
            "exposesFilePaths": false,
            "safe": true
          }
        ],
        "securityIssues": 1,
        "totalEndpoints": 11,
        "note": "Most endpoints lack security headers - consider adding security middleware"
      }
    },
    {
      "testName": "HTTP Method Security Testing",
      "status": "pass",
      "duration": 12,
      "details": {
        "testResults": [
          {
            "endpoint": "/api/health",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/health",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/health",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/profile",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "GET",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "POST",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PUT",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "DELETE",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "PATCH",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "HEAD",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "TRACE",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'TRACE' HTTP method is unsupported."
          },
          {
            "endpoint": "/api/services",
            "method": "CONNECT",
            "status": 0,
            "allowed": false,
            "safe": false,
            "error": "'CONNECT' HTTP method is unsupported."
          }
        ],
        "dangerousMethodsAllowed": 0,
        "optionsResults": [
          {
            "endpoint": "/api/health",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/profile",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          },
          {
            "endpoint": "/api/services",
            "method": "OPTIONS",
            "status": 200,
            "allowed": true,
            "safe": true
          }
        ],
        "totalTests": 27,
        "note": "HTTP method restrictions should be implemented for production"
      }
    }
  ],
  "summary": {
    "criticalIssues": 3,
    "warnings": 5,
    "recommendations": [
      "Fix authentication security failures before production deployment",
      "Add X-Content-Type-Options: nosniff header",
      "Add X-Frame-Options header to prevent clickjacking",
      "Add Strict-Transport-Security header for HTTPS enforcement",
      "Address input validation failures to prevent injection attacks",
      "Fix API security issues before production",
      "Implement rate limiting to prevent abuse",
      "Add security headers to all API endpoints",
      "Consider implementing Content Security Policy (CSP) headers",
      "Add request logging and monitoring for security events",
      "Implement proper error handling to prevent information disclosure",
      "Consider adding API authentication for sensitive endpoints",
      "Implement CORS policy appropriate for production environment"
    ]
  }
}